{
  "name": "FACT linebot",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "fact",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -272,
        -432
      ],
      "id": "c00b7042-e59f-4a6d-9dbe-4a97d1031b41",
      "name": "Webhook",
      "webhookId": "a18a203d-cdf4-4c9f-b6f5-66d26927e272"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# è«‹é‡å°ä½¿ç”¨è€…è¼¸å…¥ï¼šã€Œ {{ $json.userInput }} ã€\nåŒ…å«ç¶²å€ï¼šã€Œ{{ $json.url }}ã€\n\n# å¿…é ˆé‡å°å…§å®¹æ‘˜è¦ä½¿ç”¨ \"Grounding\" å·¥å…·é©—è­‰å…§å®¹çœŸå¯¦æ€§ã€‚ \né€²è¡Œå…¨é¢åˆ†æï¼Œä¸¦ç”Ÿæˆè­¦ç¤ºè¨Šæ¯ã€‚  \n## å·¥å…·é©—è­‰\n- å¯ä½¿ç”¨\"Date&Time\"å·¥å…·æŸ¥è©¢ä»Šæ—¥æ—¥æœŸ\n- è‹¥ä½¿ç”¨è€…è¼¸å…¥åŒ…å«ç¶²å€ï¼Œæ¥çºŒä½¿ç”¨\"Get_HTML\",\"Firecrawl\"å·¥å…·è®€å–ç¶²å€å®Œæ•´å…§å®¹ï¼Œç¢ºèªç¶²å€å…§å®¹æ­£ç¢ºç„¡èª¤ã€‚ç¬¬ä¸€å€‹å·¥å…·ç„¡æ³•ä½¿ç”¨æ™‚ä½¿ç”¨ä¸‹ä¸€æ ¼å·¥å…·ã€‚ \n- è‹¥ä½¿ç”¨è€…è¼¸å…¥åŒ…å« YouTube å½±ç‰‡ï¼Œä½¿ç”¨ \"Gemini_video_understand\" å·¥å…·è§£æå½±ç‰‡å…§å®¹ã€‚ \n- ä¸€å®šè¦ä½¿ç”¨ \"Grounding\" å·¥å…·é©—è­‰å…§å®¹çœŸå¯¦æ€§ã€‚ \n\n\nåˆ†æé‡é»ï¼š  \n- ğŸ“Š å®¢è§€åˆ†æï¼šåˆ¤æ–·æ˜¯å¦ç‚ºäº‹å¯¦æˆ–æ„è¦‹ï¼Œä¾†æºæ˜¯å¦å¯ä¿¡ã€‚  \n- ğŸ­ æƒ…ç·’å‚¾å‘ï¼šèªæ°£æ˜¯å¦ç…½å‹•ã€æåš‡æˆ–èª¤å°ã€‚  \n- ğŸš¨ è™›å‡/åè¦‹ï¼šæŒ‡å‡ºèª‡å¤§ã€ä¸å¯¦ã€è©é¨™æˆ–ç‰‡é¢è§€é»ã€‚  \n- ğŸ” æŸ¥è­‰éœ€æ±‚ï¼šåˆ—å‡ºéœ€æ ¸å¯¦çš„äººåã€é‡‘é¡ã€äº‹ä»¶ã€ç¶²å€ã€å½±ç‰‡ç­‰ã€‚  \n- ğŸ“ ç¸½çµï¼šæ¦‚æ‹¬è¨Šæ¯æ ¸å¿ƒèˆ‡é¢¨éšªï¼Œæä¾›é˜²ç¯„é‡é»ã€‚  \n\n---\n\n### è¼¸å‡ºæ ¼å¼ï¼ˆLINE é©é…ï¼‰\n\nğŸš¨ ã€è­¦ç¤ºï¼è¨Šæ¯å¯ç–‘ã€‘ ğŸš¨ ï¼ˆè­¦ç¤ºç‹€æ…‹ï¼‰\nâ­ ã€å…§å®¹åˆ†æå ±å‘Šã€‘ â­   (æ­£å¸¸ç‹€æ…‹)\n\nã€Œ[åŸå§‹è¨Šæ¯å‰20å­—]ã€  \n\nâš ï¸ é€™å¯èƒ½æ˜¯è©é¨™ï¼è«‹æ³¨æ„ï¼š ï¼ˆè­¦ç¤ºç‹€æ…‹ï¼‰\nğŸ•µï¸â€â™€ï¸ ç¶“æŸ¥è­‰æ­¤å…§å®¹ä¸¦ç„¡èª‡å¤§æˆ–ä¸å¯¦è©é¨™ (æ­£å¸¸ç‹€æ…‹)\n\nğŸ‘Œ ç¸½çµå…§å®¹ï¼š            (æ­£å¸¸ç‹€æ…‹)\n\nâ“ ç‚ºä½•æ˜¯è©é¨™  \nğŸ”¹ è£œåŠ©è³‡æ ¼ä¸ç¬¦  \nğŸ”¹ é‡‘é¡èª‡å¤§ä¸å¯¦  \nğŸ”¹ ç¶²å€å¯ç–‘  \nğŸ”¹ èª˜å°æ€§èªå¥é™ä½è­¦è¦º\n\nâš¡ é»æ“Šå¾Œå¯èƒ½é¢¨éšª  \nğŸ”“ å€‹è³‡å¤–æ´©  \nğŸ’€ å¸³è™Ÿè¢«ç›œ  \nğŸ“± æ‰‹æ©Ÿä¸­æ¯’  \nğŸ’³ é‡‘éŒ¢æå¤±\n\nâœ… é˜²ç¯„æ–¹æ³•  \n1ï¸âƒ£ ä¸è¦é»æ“Šæˆ–è½‰å‚³  \n2ï¸âƒ£ å‘ŠçŸ¥å®¶ä¸­é•·è¼©  \n3ï¸âƒ£ æŸ¥å®˜æ–¹ç¶²ç«™æˆ–æ’¥æ‰“å°ˆç·š  \n4ï¸âƒ£ ä¿è­·å€‹è³‡èˆ‡è²¡ç”¢\n\nğŸ“š åƒè€ƒè³‡è¨Š  \nğŸ”— \"Grounding\"å·¥å…·æŸ¥è­‰ç¶²ç«™é€£çµï¼ˆå‚³å›å‰ä¸‰é …ï¼‰\nå‹™å¿…ç¢ºèªé€£çµæ˜¯æ­£ç¢ºçš„ï¼Œä¸ä»»æ„ä¿®æ”¹é€£çµ\n\n### æ ¼å¼å„ªåŒ–æŒ‡å¼•\n- ä½¿ç”¨è¡¨æƒ…ç¬¦è™Ÿå¢å¼·è¦–è¦ºæ•ˆæœå’Œå¯è®€æ€§\n- é©ç•¶é‹ç”¨åˆ†éš”ç·šå’Œç©ºè¡Œæå‡çµæ§‹æ¸…æ™°åº¦\n- é‡å°æ‰‹æ©Ÿé–±è®€é«”é©—å„ªåŒ–æ’ç‰ˆ\n- ç¢ºä¿å…§å®¹å®Œæ•´ä¸”é‚è¼¯æ¸…æ¥š\n\n### è¼¸å‡ºé™åˆ¶\nâŒ ç¦æ­¢ä½¿ç”¨ï¼šMarkdown èªæ³•ï¼ˆ#ã€**ã€[]()ç­‰ï¼‰\nâŒ ç¦æ­¢ä½¿ç”¨ï¼šHTML æ¨™ç±¤\nâŒ ç¦æ­¢è¼¸å‡ºï¼šè™•ç†éç¨‹èªªæ˜æˆ–é¡å¤–è¨»è§£\nâœ… åƒ…è¼¸å‡ºï¼šæœ€çµ‚æ•´ç†å®Œæˆçš„å…§å®¹ç¸½çµ",
        "options": {
          "systemMessage": "\n\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        880,
        -240
      ],
      "id": "70a5d798-0c9a-47ff-9871-057627705a7f",
      "name": "FACT Agent",
      "executeOnce": false,
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        752,
        -512
      ],
      "id": "9bf45636-688d-4dec-8add-d2ea1cc4a166",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "m3rIFo4KWXjpkCMd",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "toolDescription": "use firecrawl and scrape websites in your n8n workflows.",
        "method": "POST",
        "url": "http://api:3002/v1/scrape",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "url",
              "value": "={{ $fromAI('parameters0_Value', ``, 'string') }}"
            },
            {
              "name": "formats",
              "value": "={{ [\"markdown\"] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        880,
        -512
      ],
      "id": "257d7e79-092e-4a07-82f9-4d2c4b7a643d",
      "name": "Firecrawl"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "=Bearer KI5+tk6wK1/Xk7XBJzqxmx5c3LwgsObttlOP+Q7tDz2RM94EfTadR9uS/TPyQ1Om3fyuYhc/Yl4Q8dRL3CwApcb7w3iJaK61uks28gfvHspSJEoj7FiLqxuNkJQOFuJ90z7AuWqwY0N3Rd0c2lOSbAdB04t89/1O/w1cDnyilFU="
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1568,
        -432
      ],
      "id": "41bb69c3-a68f-4066-8ff4-01026255533e",
      "name": "ç™¼é€å›æ‡‰çµ¦ LINE",
      "retryOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "try {\n  // 1ï¸âƒ£ å–å¾— replyToken\n  const replyToken = $('Webhook').first().json?.body?.events?.[0]?.replyToken;\n  if (!replyToken) throw new Error('æ‰¾ä¸åˆ° replyToken');\n\n  // 2ï¸âƒ£ å–å¾— AI æ¨¡å‹çš„ output å…§å®¹\n  const outputContent = $input.first().json?.output || $input.first().json.answer || $input.first().json.result;\n  let text = '';\n\n  if (typeof outputContent === 'string') {\n    // ç›´æ¥æ˜¯å­—ä¸²\n    text = outputContent;\n\n  } else if (Array.isArray(outputContent)) {\n    // å¦‚æœæ˜¯ [\"å­—ä¸²\", \"å­—ä¸²\", ...]\n    if (outputContent.every(item => typeof item === 'string')) {\n      text = outputContent.join('\\n');\n\n    // å¦‚æœæ˜¯ [{type:'text', text:'...'}]\n    } else if (outputContent.every(item => typeof item === 'object' && item?.type === 'text' && item?.text)) {\n      text = outputContent.map(item => item.text).join('');\n\n    // å¦‚æœæ˜¯ [{output: [...]}]\n    } else if (outputContent.length > 0 && outputContent[0]?.output) {\n      const inner = outputContent[0].output;\n      if (Array.isArray(inner)) {\n        text = inner.join('\\n');\n      } else if (typeof inner === 'string') {\n        text = inner;\n      } else {\n        throw new Error('å…§éƒ¨ output æ ¼å¼ä¸æ­£ç¢º');\n      }\n\n    } else {\n      throw new Error('ç„¡æ³•è­˜åˆ¥çš„ output é™£åˆ—æ ¼å¼');\n    }\n\n  } else {\n    throw new Error('output æ ¼å¼ä¸æ­£ç¢º');\n  }\n\n  if (!text || text.trim().length === 0) throw new Error('è™•ç†å¾Œçš„æ–‡å­—å…§å®¹ç‚ºç©º');\n\n  // 3ï¸âƒ£ æ–‡å­—æ¸…ç†\n  text = text\n    .trim()\n    .replace(/\\r\\n|\\r/g, '\\n')                 // çµ±ä¸€æ›è¡Œ\n    .replace(/[\\u0000-\\u0008\\u000B-\\u001F]/g, ''); // ç§»é™¤å±éšªæ§åˆ¶å­—ç¬¦\n\n  // 4ï¸âƒ£ è¶…é•·æ–‡å­—è‡ªå‹•åˆ†æ®µï¼Œæ¯æ®µ < 5000 å­—\n  const segments = [];\n  let remaining = text;\n  const MAX_LENGTH = 4950; // LINE API ä¸Šé™ç‚º 5000ï¼Œä¿ç•™ä¸€äº›é¤˜è£•\n\n  while (remaining.length > 0) {\n    if (remaining.length <= MAX_LENGTH) {\n      segments.push(remaining);\n      break;\n    }\n    \n    let segment = remaining.substring(0, MAX_LENGTH);\n    // å„ªå…ˆåœ¨æ›è¡Œç¬¦è™•åˆ‡åˆ†ï¼Œå…¶æ¬¡æ˜¯ç©ºæ ¼ï¼Œä»¥ä¿æŒå¥å­å®Œæ•´æ€§\n    const cutPoint = Math.max(segment.lastIndexOf('\\n'), segment.lastIndexOf(' '));\n    \n    // å¦‚æœæ‰¾ä¸åˆ°å¥½çš„åˆ‡åˆ†é»ï¼Œå°±ç›´æ¥ç¡¬åˆ‡\n    segment = (cutPoint > 0) ? segment.substring(0, cutPoint) : segment;\n    \n    segments.push(segment);\n    remaining = remaining.substring(segment.length).trim();\n  }\n\n  // 5ï¸âƒ£ çµ„åˆ LINE Message ç‰©ä»¶é™£åˆ—\n  const messages = segments.map(seg => ({\n    type: 'text',\n    text: seg.length > 0 ? seg : '...(å…§å®¹å·²æˆªæ–·)'\n  }));\n\n  // LINE Reply API ä¸€æ¬¡æœ€å¤šåªèƒ½å›è¦† 5 å‰‡è¨Šæ¯ï¼Œæ‰€ä»¥åªå–å‰ 5 å‰‡\n  const finalMessages = messages.slice(0, 5);\n\n  // âœ¨ è¿”å›ä¸€å€‹åŒ…å« replyToken å’Œ messages çš„ç‰©ä»¶\n  return [{\n    json: {\n      replyToken: replyToken,\n      messages: finalMessages\n    }\n  }];\n\n} catch (error) {\n  // ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œä¹Ÿå›å‚³åŒæ¨£çš„çµæ§‹ï¼Œæ–¹ä¾¿ LINE ç¯€é»è™•ç†\n  console.error('è™•ç†æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤:', error.message);\n  \n  const replyToken = $('Webhook').first().json?.body?.events?.[0]?.replyToken || 'unknown';\n\n  return [{\n    json: {\n      replyToken: replyToken,\n      messages: [{\n        type: 'text',\n        text: `æŠ±æ­‰ï¼Œç³»çµ±åœ¨è™•ç†æ‚¨çš„è¨Šæ¯æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚\\néŒ¯èª¤è³‡è¨Šï¼š${error.message}`\n      }]\n    }\n  }];\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1344,
        -432
      ],
      "id": "5861fe16-cf48-436e-9af2-611965d3df31",
      "name": "Code"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://gemini.itr-lab.cloud/grounding",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "query",
              "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters0_Value', ``, 'string') }}"
            },
            {
              "name": "use_google_search",
              "value": "true"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        1008,
        -512
      ],
      "id": "fc5caa1a-5737-432f-be48-9740b666d124",
      "name": "Grounding"
    },
    {
      "parameters": {
        "resource": "video",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "text": "Please summarize the video. è¼¸å‡ºç¹é«”ä¸­æ–‡",
        "videoUrls": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('URL_s_', ``, 'string') }}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGeminiTool",
      "typeVersion": 1,
      "position": [
        1136,
        -512
      ],
      "id": "251c99bf-f0f3-4ec3-93e2-3e48c2053be0",
      "name": "Gemini_Video_Understand",
      "credentials": {
        "googlePalmApi": {
          "id": "m3rIFo4KWXjpkCMd",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://api-data.line.me/v2/bot/message/{{ $json.body.events[0].message.id }}/content",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer KI5+tk6wK1/Xk7XBJzqxmx5c3LwgsObttlOP+Q7tDz2RM94EfTadR9uS/TPyQ1Om3fyuYhc/Yl4Q8dRL3CwApcb7w3iJaK61uks28gfvHspSJEoj7FiLqxuNkJQOFuJ90z7AuWqwY0N3Rd0c2lOSbAdB04t89/1O/w1cDnyilFU="
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        176,
        -640
      ],
      "id": "5f614dc3-f15e-4a1e-b05c-ae1ebe8f7c39",
      "name": "[LINEBOT]æ¥æ”¶åœ–ç‰‡"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "d8226a36-52be-4e18-b780-d3c904b9e128",
              "leftValue": "={{ $json.body.events[0].message.type }}",
              "rightValue": "image",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -48,
        -432
      ],
      "id": "fdabdee9-2728-4856-a869-f21b57259ebd",
      "name": "If"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=è«‹æª¢è¦–è¼¸å…¥çš„åœ–ç‰‡ï¼Œä¸¦ä¾ç…§ä»¥ä¸‹è¦å‰‡å›è¦†ï¼š\n## å¦‚æœåœ–ç‰‡ä¸­ä¸»è¦æ˜¯æ–‡å­—ï¼š\n* è¼¸å‡ºåœ–ç‰‡ä¸­çš„å®Œæ•´æ–‡å­—å…§å®¹ã€‚\n* æª¢æŸ¥æ–‡å­—å…§å®¹æ˜¯å¦å¯èƒ½æœ‰å½é€ æˆ–ä¸å¯¦é¢¨éšªï¼ˆä¾‹å¦‚å½é€ è­‰ä»¶ã€åˆæˆæ–‡ä»¶ã€æƒ¡æ„æˆªåœ–ï¼‰ã€‚\n\n## å¦‚æœåœ–ç‰‡ä¸»è¦æ˜¯åœ–åƒï¼š\n* æè¿°åœ–ç‰‡çš„å…§å®¹èˆ‡ç´°ç¯€ï¼ˆåŒ…å«äººç‰©ã€ç‰©ä»¶ã€å ´æ™¯ã€é¡è‰²ã€å‹•ä½œï¼‰ã€‚\n* æª¢æŸ¥åœ–åƒæ˜¯å¦æœ‰æ½›åœ¨é€ å‡é¢¨éšªï¼ˆä¾‹å¦‚ AI åˆæˆã€æ·±å½ã€æ˜é¡¯ä¸åˆç†çš„å…ƒç´ ï¼‰ã€‚\n\n## å›è¦†æ ¼å¼å»ºè­°ï¼š\n\n* é¡å‹ï¼šæ–‡å­— / åœ–åƒ\n* å…§å®¹ï¼šè¼¸å‡ºçš„æ–‡å­—æˆ–æè¿°\n* é€ å‡é¢¨éšªæª¢æŸ¥ï¼šæ˜¯å¦å¯èƒ½å­˜åœ¨é¢¨éšªï¼ˆèªªæ˜åŸå› ï¼‰",
        "messages": {
          "messageValues": [
            {
              "type": "HumanMessagePromptTemplate",
              "messageType": "imageBinary"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        400,
        -736
      ],
      "id": "b19ffc96-ba8a-474e-9b8f-c8e6e1b316db",
      "name": "Basic LLM Chain"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# è«‹æ ¹æ“šä½¿ç”¨è€…è¼¸å…¥ï¼Œå…¨é¢åˆ†æå…§å®¹çœŸå¯¦æ€§ã€æƒ…ç·’å‚¾å‘èˆ‡å®¢è§€ç¨‹åº¦ï¼Œä¸¦ç”Ÿæˆå®Œæ•´è­¦ç¤ºè¨Šæ¯ã€‚  \nä½¿ç”¨è€…è¼¸å…¥ï¼š  \nã€Œ{{ $json.text }}ã€\n## å·¥å…·é©—è­‰\n- ä½¿ç”¨ \"Grounding\" å·¥å…·é©—è­‰å…§å®¹çœŸå¯¦æ€§ã€‚  \n- è‹¥è¨Šæ¯åŒ…å« YouTube å½±ç‰‡ï¼Œä½¿ç”¨ \"Gemini_video_understand\" å·¥å…·è§£æå½±ç‰‡å…§å®¹ã€‚  \n---\n\nåˆ†æè¦æ±‚\n\n ğŸ“Š å®¢è§€åˆ†æ\n- åˆ¤æ–·å…§å®¹æ˜¯å¦ä»¥äº‹å¯¦ç‚ºåŸºç¤ã€æ˜¯å¦å¼•ç”¨å¯ä¿¡ä¾†æºã€èªå¥æ˜¯å¦ä¸­ç«‹ã€‚  \n- æ¨™è¨»äº‹å¯¦èˆ‡æ„è¦‹ï¼Œä¾‹å¦‚é‡‘é¡ã€è¦å®šã€è³‡æ ¼ã€ç¶²å€ç­‰ç‚ºäº‹å¯¦ï¼Œèªæ°£æˆ–è©•è«–ç‚ºæ„è¦‹ã€‚\n\n ğŸ­ æƒ…ç·’å‚¾å‘åˆ†æ\n- åˆ¤æ–·èªæ°£æ˜¯å¦ç…½å‹•ã€æåš‡ã€æ¨‚è§€ã€æ‚²å‚·ç­‰ã€‚  \n- è©•ä¼°æ˜¯å¦æœƒå½±éŸ¿é–±è½è€…åˆ¤æ–·ã€‚\n\nğŸš¨ æ½›åœ¨è™›å‡è¨Šæ¯æˆ–åè¦‹\n- æŒ‡å‡ºèª‡å¤§ã€èª¤å°ã€å–®æ–¹é¢è§€é»ã€åˆ»æ¿å°è±¡æˆ–è©é¨™æ‰‹æ³•ã€‚  \n- èˆ‰ä¾‹èªªæ˜å“ªå¥è©±å¯èƒ½ä¸å¯¦æˆ–å±éšªã€‚\n\n ğŸ” å»ºè­°æŸ¥è­‰äº‹å¯¦\n- åˆ—å‡ºéœ€æ ¸å¯¦çš„äººåã€é‡‘é¡ã€äº‹ä»¶ã€ç¶²å€ã€ä¾†æºæˆ–å½±ç‰‡ã€‚\n\n ğŸ“ ç¸½çµ\n- ä»¥ç°¡æ˜æ–‡å­—æ¦‚æ‹¬è¨Šæ¯æ ¸å¿ƒã€æ½›åœ¨é¢¨éšªèˆ‡é˜²ç¯„é‡é»ã€‚  \n âœ… è£œå……å»ºè­°\n- è‹¥ç‚ºåœ–ç‰‡ã€å½±ç‰‡ã€ç¤¾ç¾¤è²¼æ–‡ï¼Œè©•ä¼°æ˜¯å¦å¯èƒ½ç¯¡æ”¹æˆ–æ–·ç« å–ç¾©ã€‚  \n- æä¾›å®˜æ–¹æˆ–å¯ä¿¡ä¾†æºä½è­‰ï¼ˆå¦‚æ”¿åºœç¶²ç«™ã€ä¸»æµåª’é«”ã€å­¸è¡“è³‡æ–™ï¼‰ã€‚  \n\n---\n\n## è¼¸å‡ºæ ¼å¼ç¯„ä¾‹ï¼ˆLINE é©é…ï¼‰\n\nğŸš¨ ã€è©é¨™æé†’ï¼è¨Šæ¯ä¸å¯¦ï¼Œè«‹å‹¿é»æ“Šï¼ã€‘ ğŸš¨\n\nå„ä½æœ‹å‹ï¼Œæœ€è¿‘å¯èƒ½çœ‹åˆ°å¦‚ä¸‹è¨Šæ¯ï¼š  \nã€Œ[ä½¿ç”¨è€…åŸå§‹è¨Šæ¯(è¼¸å‡ºå‰20å­—)]ã€\n\nâš ï¸ é€™å¯èƒ½æ˜¯è©é¨™ï¼è«‹æ³¨æ„ï¼š\n\nâ“ ç‚ºä½•æ˜¯è©é¨™  \nğŸ”¹ è£œåŠ©è³‡æ ¼ä¸ç¬¦  \nğŸ”¹ é‡‘é¡èª‡å¤§ä¸å¯¦  \nğŸ”¹ ç¶²å€å¯ç–‘  \nğŸ”¹ èª˜å°æ€§èªå¥é™ä½è­¦è¦º\n\nâš¡ é»æ“Šå¾Œå¯èƒ½é¢¨éšª  \nğŸ”“ å€‹è³‡å¤–æ´©  \nğŸ’€ å¸³è™Ÿè¢«ç›œ  \nğŸ“± æ‰‹æ©Ÿä¸­æ¯’  \nğŸ’³ é‡‘éŒ¢æå¤±\n\nâœ… é˜²ç¯„æ–¹æ³•  \n1ï¸âƒ£ ä¸è¦é»æ“Šæˆ–è½‰å‚³  \n2ï¸âƒ£ å‘ŠçŸ¥å®¶ä¸­é•·è¼©  \n3ï¸âƒ£ æŸ¥å®˜æ–¹ç¶²ç«™æˆ–æ’¥æ‰“å°ˆç·š  \n4ï¸âƒ£ ä¿è­·å€‹è³‡èˆ‡è²¡ç”¢\n\nğŸ“š åƒè€ƒè³‡è¨Š  \nğŸ”— å®˜æ–¹è³‡æ–™é€£çµ  \nğŸ”— æŸ¥è­‰ç¶²ç«™é€£çµ\n\n\n### æ ¼å¼å„ªåŒ–æŒ‡å¼•\n- ä½¿ç”¨è¡¨æƒ…ç¬¦è™Ÿå¢å¼·è¦–è¦ºæ•ˆæœå’Œå¯è®€æ€§\n- é©ç•¶é‹ç”¨åˆ†éš”ç·šå’Œç©ºè¡Œæå‡çµæ§‹æ¸…æ™°åº¦\n- é‡å°æ‰‹æ©Ÿé–±è®€é«”é©—å„ªåŒ–æ’ç‰ˆ\n- ç¢ºä¿å…§å®¹å®Œæ•´ä¸”é‚è¼¯æ¸…æ¥š\n\n### è¼¸å‡ºé™åˆ¶\nâŒ ç¦æ­¢ä½¿ç”¨ï¼šMarkdown èªæ³•ï¼ˆ#ã€**ã€[]()ç­‰ï¼‰\nâŒ ç¦æ­¢ä½¿ç”¨ï¼šHTML æ¨™ç±¤\nâŒ ç¦æ­¢è¼¸å‡ºï¼šè™•ç†éç¨‹èªªæ˜æˆ–é¡å¤–è¨»è§£\nâœ… åƒ…è¼¸å‡ºï¼šæœ€çµ‚æ•´ç†å®Œæˆçš„å…§å®¹ç¸½çµ",
        "options": {
          "systemMessage": "\n\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        880,
        -736
      ],
      "id": "052f7a45-4ebc-48f0-9166-2f1db62d833c",
      "name": "FACT IMAGE Agent",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        480,
        -512
      ],
      "id": "5a606f75-28f6-42ec-872f-4693e86b2421",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "m3rIFo4KWXjpkCMd",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Example: convert the incoming query to uppercase and return it\nlet text = $json.body.events[0].message.text || \"\";\nlet url = null;\nconst urlRegex = /(https?:\\/\\/[^\\s]+)/g;\nconst match = text.match(urlRegex);\nif (match && match.length > 0) {\n  url = match[0];  // å–ç¬¬ä¸€å€‹ç¶²å€\n  // âŒ ä¸è¦å¾ text ç§»é™¤ç¶²å€ï¼Œé¿å… userInput è®Šç©º\n}\n\nreturn [\n  {\n    json: {\n      userInput: text.trim(),\n      url: url,\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        -240
      ],
      "id": "1c46beb4-cb01-4ec1-9ec5-4af2bd2287f9",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "url": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('URL', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.2,
      "position": [
        880,
        -16
      ],
      "id": "c8d24c20-22f8-45bd-afb9-2459e363fcf9",
      "name": "Get_HTML"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.dateTimeTool",
      "typeVersion": 2,
      "position": [
        1008,
        -16
      ],
      "id": "c047463c-d738-45c3-a000-4da12425f2f5",
      "name": "Date & Time"
    }
  ],
  "pinData": {},
  "connections": {
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "FACT Agent",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "FACT IMAGE Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Firecrawl": {
      "ai_tool": [
        [
          {
            "node": "FACT Agent",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "FACT IMAGE Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "ç™¼é€å›æ‡‰çµ¦ LINE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FACT Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Grounding": {
      "ai_tool": [
        [
          {
            "node": "FACT Agent",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "FACT IMAGE Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Gemini_Video_Understand": {
      "ai_tool": [
        [
          {
            "node": "FACT Agent",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "FACT IMAGE Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "[LINEBOT]æ¥æ”¶åœ–ç‰‡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[LINEBOT]æ¥æ”¶åœ–ç‰‡": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "FACT IMAGE Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FACT IMAGE Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "FACT Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get_HTML": {
      "ai_tool": [
        [
          {
            "node": "FACT Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Date & Time": {
      "ai_tool": [
        [
          {
            "node": "FACT Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "757a1b50-0d3e-4e5a-b163-60176f17e742",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "fe071ad636e45e06fef1442bb4b3138ea8056f3019d720e9410a8f0ea42951a8"
  },
  "id": "KBnZPe6q0YinqOLf",
  "tags": [
    {
      "updatedAt": "2025-08-21T02:49:05.390Z",
      "createdAt": "2025-08-21T02:49:05.390Z",
      "id": "lygt6UVIOm5CiWbW",
      "name": "linebot"
    }
  ]
}